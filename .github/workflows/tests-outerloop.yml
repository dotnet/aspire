# Executes outerloop tests
#
# COPILOT INSTRUCTIONS:
# - Keep the 'paths:' list in sync across tests-outerloop.yml and
#   tests-quarantine.yml
# - Validate that each path exists in the repository before adding or
#   updating the list
# - No external YAML file is usedâ€”only the workflow YAMLs themselves
#   hold the list
# - The 'paths:' filter applies only to pull_request triggers, not to
#   push triggers to main
#
name: Outerloop Tests

on:
  workflow_dispatch:

  schedule:
    - cron: '0 2 * * *'  # Daily at 02:00 UTC

  # Trigger on pull requests that modify infrastructure or workflow files
  pull_request:
    paths:
      - '.github/workflows/*.yml'
      - 'build/**'
      - 'eng/**'
      - 'scripts/**'
      - 'tools/**'
      - '.github/actions/**'

  # Push to main triggers without path restrictions
  push:
    branches:
      - main

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  outerloop_tests:
    uses: ./.github/workflows/specialized-test-runner.yml
    with:
      testRunnerName: "OuterloopTestRunsheetBuilder"
      extraRunSheetBuilderArgs: "-p:RunOuterloopTests=true"
      extraTestArgs: "--filter-trait outerloop=true"
      enablePlaywrightInstall: true
