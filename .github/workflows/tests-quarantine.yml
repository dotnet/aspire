# Executes quarantined tests
#
# COPILOT INSTRUCTIONS:
# - Keep the 'paths:' list in sync across tests-outerloop.yml and
#   tests-quarantine.yml
# - Validate that each path exists in the repository before adding or
#   updating the list
# - No external YAML file is usedâ€”only the workflow YAMLs themselves
#   hold the list
#
name: Quarantined Tests

on:
  workflow_dispatch:

  schedule:
    # Run every 4 hours
    - cron: '0 */4 * * *'

  # TEMPORARILY DISABLED pull_request trigger due to #12143 (disk space issues): https://github.com/dotnet/aspire/issues/12143
  # pull_request:
  #   paths:
  #     - '.github/actions/**'
  #     - '.github/workflows/**'
  #     - 'eng/**'
  #     - '!eng/pipelines/**'
  #     - '!eng/scripts/**'
  #     - '!eng/*pack/**'

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  quarantine_tests:
    uses: ./.github/workflows/specialized-test-runner.yml
    with:
      testRunnerName: "QuarantinedTestRunsheetBuilder"
      attributeName: "QuarantinedTest"
      extraRunSheetBuilderArgs: "-p:RunQuarantinedTests=true"
      extraTestArgs: "--filter-trait quarantined=true"
      enablePlaywrightInstall: true
      ignoreTestFailures: true
      extraSummaryArgs: "--show-all-tests"
