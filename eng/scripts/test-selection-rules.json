{
  "$schema": "./test-selection-rules.schema.json",

  "ignorePaths": [
    ".editorconfig",
    ".gitignore",
    "*.md",
    "docs/**",
    "eng/common/**",
    "eng/pipelines/**",
    "eng/*.props",
    "eng/*.targets",
    "eng/*.xml",
    ".github/workflows/**",
    ".github/actions/**",
    "tests/agent-scenarios/**",
    "eng/scripts/test-selection-rules.json",
    "eng/scripts/test-selection-rules.schema.json"
  ],

  "projectMappings": [
    {
      "sourcePattern": "src/Components/{name}/**",
      "testPattern": "tests/{name}.Tests/"
    },
    {
      "sourcePattern": "src/Aspire.Hosting.{name}/**",
      "testPattern": "tests/Aspire.Hosting.{name}.Tests/",
      "exclude": ["src/Aspire.Hosting.Testing/**"]
    },
    {
      "sourcePattern": "tests/{name}.Tests/**",
      "testPattern": "tests/{name}.Tests/"
    }
  ],

  "categories": {
    "core": {
      "description": "Critical paths - triggers ALL tests",
      "triggerAll": true,
      "triggerPaths": [
        "global.json",
        "Directory.Build.props",
        "Directory.Build.targets",
        "Directory.Packages.props",
        "NuGet.config",
        "tests/Shared/**",
        "*.sln",
        "*.slnx",
        "src/Aspire.Hosting/**"
      ]
    },

    "templates": {
      "description": "Template tests - runs on 3 platforms",
      "triggerPaths": [
        "src/Aspire.ProjectTemplates/**",
        "tests/Aspire.Templates.Tests/**"
      ],
      "projects": [
        "tests/Aspire.Templates.Tests/"
      ]
    },

    "cli_e2e": {
      "description": "CLI end-to-end tests",
      "triggerPaths": [
        "src/Aspire.Cli/**",
        "tests/Aspire.Cli.EndToEnd.Tests/**"
      ],
      "projects": [
        "tests/Aspire.Cli.EndToEnd.Tests/"
      ]
    },

    "endtoend": {
      "description": "General E2E tests",
      "triggerPaths": [
        "tests/Aspire.EndToEnd.Tests/**",
        "playground/**"
      ],
      "projects": [
        "tests/Aspire.EndToEnd.Tests/"
      ]
    },

    "integrations": {
      "description": "Integration tests - 3 platforms x ~20 projects",
      "triggerPaths": [
        "src/Aspire.*/**",
        "src/Components/**",
        "src/Grafana/**",
        "src/Schema/**",
        "src/Shared/**",
        "src/Tools/**",
        "src/Vendoring/**",
        "tests/Aspire.*.Tests/**"
      ],
      "excludePaths": [
        "src/Aspire.ProjectTemplates/**",
        "src/Aspire.Cli/**",
        "tests/Aspire.Templates.Tests/**",
        "tests/Aspire.EndToEnd.Tests/**",
        "tests/Aspire.Cli.EndToEnd.Tests/**",
        "tests/Infrastructure.Tests/**"
      ],
      "projects": []
    },

    "extension": {
      "description": "VS Code extension tests",
      "triggerPaths": [
        "extension/**"
      ],
      "projects": []
    },

    "infrastructure": {
      "description": "Infrastructure and CI tests",
      "triggerPaths": [
        "tests/Infrastructure.Tests/**",
        "eng/scripts/Evaluate-TestSelection.ps1"
      ],
      "projects": [
        "tests/Infrastructure.Tests/"
      ]
    }
  }
}
